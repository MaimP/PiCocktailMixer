<html>
	<head>
		<meta charset="UTF-8">
  		<link href="nouislider.css" rel="stylesheet">
		<script src="nouislider.js"></script>
  		<style>
			.noUi-connect {
			    background: cyan;
			}

			.noUi-horizontal .noUi-handle {
			    background: black;
			    box-shadow: none !important;
			}
		</style>
	</head>
	<body>
		<div id="slider"></div> <!-- Wir erstellen ein leeres Element für den Slider -->
		<div id="getraenke"></div>  <!-- Und für die Liste -->

		<form method="post" action="/doform">
				<select id="select_1" name="drink1">
						<option value="0">Korn</option>
						<option value="1">Bacardi</option>
						<option value="2">Vodka</option>
						<option value="3">Fanta</option>
						<option value="4">Cola</option>
						<option value="5">Sprite</option>
						<option value="6" selected="">keins</option>
				</select><br>
						<select id="select_2" name="drink2">
						<option value="0">Korn</option>
						<option value="1">Bacardi</option>
						<option value="2">Vodka</option>
						<option value="3">Fanta</option>
						<option value="4">Cola</option>
						<option value="5">Sprite</option>
						<option value="6" selected="">keins</option>
				</select><br>
						<select id="select_3" name="drink3">
						<option value="0">Korn</option>
						<option value="1">Bacardi</option>
						<option value="2">Vodka</option>
						<option value="3">Fanta</option>
						<option value="4">Cola</option>
						<option value="5">Sprite</option>
						<option value="6" selected="">keins</option>
				</select><br>
						<select id="select_4" name="drink4">
						<option value="0">Korn</option>
						<option value="1">Bacardi</option>
						<option value="2">Vodka</option>
						<option value="3">Fanta</option>
						<option value="4">Cola</option>
						<option value="5">Sprite</option>
						<option value="6" selected="">keins</option>
				</select><br>
						<select id="select_5" name="drink5">
						<option value="0">Korn</option>
						<option value="1">Bacardi</option>
						<option value="2">Vodka</option>
						<option value="3">Fanta</option>
						<option value="4">Cola</option>
						<option value="5">Sprite</option>
						<option value="6" selected="">keins</option>
				</select><br>
						<select id="select_6" name="drink6">
						<option value="0">Korn</option>
						<option value="1">Bacardi</option>
						<option value="2">Vodka</option>
						<option value="3">Fanta</option>
						<option value="4">Cola</option>
						<option value="5">Sprite</option>
						<option value="6" selected="">keins</option>
				</select><br>

						<button type="submit">Submit</button>
		</form>

		<script>
			// Das Element für den Slider suchen
			var slider = document.getElementById('slider');

			const min = 0 // Konstante für Minimum und
			const max = 100 // Maximum

			// Basis für die Optionen des Sliders
			sliderOptions = {
				connect: true,
		   		range: {
		        	'min': min,
		        	'max': max
		    	},
		    	margin: 5, // Mindestentfernung zwischen einzelnen Handles

		    	// Beschriftung für den Slider
		    	pips: {
		    	    mode: 'steps',
		    	    stepped: true,
		    	    density: 4
		    	},
			}

			function setGetraenke(numGetr) {
				liste = document.getElementById('getraenke')

				str = "<h1>Liste der Getränke</h1>"

				// Für jedes Getränk einen Text hinzufügen
				for (let i = 1; i <= numGetr; i++) {
					str += `<h2>Getränk ${i}: <a id="getraenk-${i}">x</a>%</h2>`
				}

				// Die Getränkeliste updaten
				liste.innerHTML = str;

				// Jetzt den Slider updaten
				makeSlider(slider, numGetr);
			}

			function makeSlider(select, numPoints) {
				// Wenn der Slider bereits initialisiert ist, die Handles zerstören
				if (select.noUiSlider != undefined)
					select.noUiSlider.destroy();

				// Lambda Funktion für die Position der Handles
				mult = (x) => x * ((max - min) / numPoints + min);

				sliderOptions.start = []; // Handles initialisieren
				for (let i = 0; i <= numPoints; i++) {
					sliderOptions.start.push(mult(i)); // Handles einzeln hinzufügen (mit dem Lambda)
				}

				// Den Slider updaten
				noUiSlider.create(select, sliderOptions);

				// Einen Event Listener erstellen
				select.noUiSlider.on('update', function() {
					// Diese Funktion wird ausgeführt, wenn die Position eines Handles sich ändert

					// Alle Werte sammeln
					var handleValues = select.noUiSlider.get();

					// Einzeln in die Getränkeliste eintragen
					for (let i = 1; i <= numPoints; i++) { // numPoints Equivalent to numGetr
						document.getElementById(`getraenk-${i}`).innerHTML = (handleValues[i] - handleValues[i-1]).toFixed(2);
					}
				})
			}

			function chnange selected() {
  			var x = document.getElementById("select_1").value;
  			document.getElementById("demo").innerHTML = "You selected: " + x;
				setGetraenke(1)
			}

			// Beim Laden der Seite erstmal 3 Getränke hinzufügen
	//		setGetraenke(3);
		</script>

	</body>
</html>
