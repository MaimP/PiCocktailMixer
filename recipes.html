<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
  </head>
  <body>
    <section class="hero is-info is-fullheight">
      <!-- Hero head: will stick at the top -->
  	  <div class="hero-head has-background-dark">
  			<nav class="navbar" role="navigation" aria-label="main navigation">
  				<div class="navbar-brand">
  					<a class="navbar-item" href="mdb.html">
  						<div class="content">
  							<p>
  								PiCocktailMixer
  							</p>
  						</div>
  					</a>

  					<a role="button" class="navbar-burger burger is-acitve" aria-label="menu" aria-expanded="false" data-target="navbarBasicExample">
  						<span aria-hidden="true"></span>
  						<span aria-hidden="true"></span>
  						<span aria-hidden="true"></span>
  					</a>
  				</div>

  				<div class="navbar-menu">
  					<div class="navbar-end">
  						<a class="navbar-item" href="mdb.html">
  							Home
  						</a>

  						<a class="navbar-item" href="mix.html">
  							Mixen
  						</a>

  						<div class="navbar-item has-dropdown is-hoverable has-background-dark">
  							<a class="navbar-link">
  								Rezepte
  							</a>

  							<div class="navbar-dropdown">
  								<a class="navbar-item" href="recipes.html">
  									Rezepte
  								</a>
  								<div class="navbar-item">
  									<div class="field">
  										<div class="control">
  											<input class="input is-primary" type="text" placeholder="search">
  										</div>
  									</div>
  								</div>
  							</div>
  						</div>
  					</div>
  				</div>
  			</nav>
      </div>
			<script>
				$(document).ready(function() {

					// Check for click events on the navbar burger icon
					$(".navbar-burger").click(function() {

							// Toggle the "is-active" class on both the "navbar-burger" and the "navbar-menu"
							$(".navbar-burger").toggleClass("is-active");
							$(".navbar-menu").toggleClass("is-active");

					});
				});
			</script>
      <div class="her-body has-background-light">
        <div class="container mt-3">
          <div class="container is-mt-3">
            <div id="recipes_id"></div>
          </div>
        </div>
      </div>
    </section>
    <script>
      var recipes;
      var shown_recipes = [];
      const elements = ["Beschreibung", "Zutaten", "Ausführung", "Stichwörter"];
      var names = [];
      $.get('/dorecipes', function(recipes_parse){
        recipes = JSON.parse(recipes_parse)
				for (let b in recipes) {
          //immer checken ob durch drei teilbar ist dann zu tile parent hinzufuegen und zum gesamten hinzufuegen
					let array = recipes[b];
					var name = array.name;
          names.push(name);

					var description = array.description;
					var ingredients_array = [];
					for (let c in array.ingredients) {
						ingredients_array.push(array.ingredients[c]);
					}
					var direction_a = array.directions;
					var keyword_array = [];
					for (var i in array.keywords) {
						keyword_array.push(array.keywords[i]);
					}

          if (b % 3 == 0) {
            var anc = document.createElement("div");
            anc.className = "tile is-ancestor";
            var vert = document.createElement("div");
            vert.className = "tile is-vertical is-12";
            var til = document.createElement("div");
            til.className = "tile";
          }
          var tile = document.createElement("div");
          tile.className = "tile is-parent is-vertical";
          for (let e = 0; e == 3; e++) {
            var artic = document.createElement("ARTICEL");
            artic.className = "tile is-child";
          }
          //erstelle leeres Panel
          var panel = document.createElement("nav");
          panel.className = "panel is-primary";
          //erstelle panel fuer ueberschrift
          var panel_heading = document.createElement("p");
          panel_heading.className = "panel-heading";
          //fuege ueberschrift hinzu
          panel_heading.appendChild(document.createTextNode(name));
          panel.appendChild(panel_heading);
          var navi = document.createElement("p");
          navi.className = "panel-tabs has-background-dark";
          //erstelle nav Elemente
          for (let d in elements) {
            var nav_element = document.createElement("a");
            //id ist name des getraenks und welcher nav
            nav_element.id = name + elements[d]
            //erstes Element ist geoeffnet
            if (d == 0){
              nav_element.className = "is-active"
            }
            var nav_text = document.createTextNode(elements[d]);
            nav_element.appendChild(nav_text);
            navi.appendChild(nav_element)
            nav_element.addEventListener (
               'click',
               function() {           // anonyme Funktion
                  test(this.id, elements[d], names[b]);
               },
               false
            );
          }

          panel.appendChild(navi)

          // body, weil erste selected ist direkt erstes anzeigen andere auch generieren,
          // aber noch nicht anzeigen
          var bodyDes = document.createElement("a");
          bodyDes.className  = "panel-block";
          bodyDes.id = name + "Beschreibung" + "1"
          var desText = document.createTextNode(description);
          bodyDes.appendChild(desText);
          panel.appendChild(bodyDes);
          shown_recipes.push(bodyDes.id)

          var bodyIng = document.createElement("a");
          bodyIng.className  = "panel-block";
          bodyIng.id = name + "Zutaten" + "1"
          var ingText = document.createTextNode(ingredients_array[0]);
          bodyIng.appendChild(ingText);
          panel.appendChild(bodyIng);

          var bodyAusf = document.createElement("a");
          bodyAusf.className  = "panel-block";
          bodyAusf.id = name + "Ausführung" + "1"
          var ausfText = document.createTextNode(description);
          bodyAusf.appendChild(ausfText);
          panel.appendChild(bodyAusf);

          var bodyStich = document.createElement("a");
          bodyStich.className  = "panel-block";
          bodyStich.id = name + "Stichwörter" + "1"
          var stichText = document.createTextNode(keyword_array[0]);
          bodyDes.appendChild(stichText);
          panel.appendChild(bodyStich);


          tile.appendChild(panel)
          til.appendChild(tile);
          vert.appendChild(til);
          anc.appendChild(vert)
          if (b % 3 == 0) {
            var id_main = document.getElementById("recipes_id");
            id_main.appendChild(anc);
          }
        }
      })

      function test(id, nav, name) {
        console.log("id: " + id)
        console.log("nav: " + nav)
        console.log("name: " + name)
        var change_elem = document.getElementById(id + "1")
        change_elem.className = "panel-block";

        var last_elem_id = shown_recipes[0]
        var last_elem = document.getElementById(last_elem_id)
        last_elem.className = "panel-block is-hidden-touch is-hidden-desktop"
        shown_recipes.pop()
        shown_recipes.push(id + "1")
        console.log(change_elem);
        console.log(last_elem)
          }
    </script>
  </body>
</html>
